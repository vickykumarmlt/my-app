def name="vikam"
pipeline{
	agent any
	tools 
	 {
	 maven 'Apache Maven 3.6.0'
	 } 
	   options {
                skipDefaultCheckout() // removes the "Declarative Checkout SCM" stage
    }
   	
	stages{
		
		stage('SCM-Checkout'){
			steps{
				git 'https://github.com/vickykumarmlt/my-app'
			} }   		
		stage('Package'){
			steps{
				sh """
				mvn clean package
				echo i Said, Hi Mr. ${name}
				echo Currnet Build Id is ${env.BUILD_ID}
				echo ${env.JOB_NAME} ${env.BUILD_NUMBER}
				echo Build URL is ${BUILD_URL} ${WORKSPACE}
				mv '${WORKSPACE}/target/my-app-1.0-SNAPSHOT.jar' '${WORKSPACE}/target/app.jar'
				"""
				stash includes: '${WORKSPACE}/target/app.jar', name: 'appp'
			}
		}
		stage('deploy'){
			when {
              			expression {
                		currentBuild.result == null || currentBuild.result == 'SUCCESS' 
              				   }
            			}
			steps{
				unstash 'appp'
				sh "java -cp '${WORKSPACE}/target/app.jar' com.mycompany.app.App" 
				}
			}
	}

}
